<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZooMingle - Social Network for Pets</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <header class="bg-success text-white text-center py-4">
        <h1>Welcome to ZooMingle - Posts</h1>
    </header>

    <div class="container mt-5">
        <div class="row">
            <div class="col-md-4">
                <h2>Your Pet's Profile</h2>
                <div id="profile" class="p-3 border bg-light"></div>
            </div>
            <div class="col-md-8">
                <h2>Create a Post</h2>
                <textarea id="postContent" class="form-control mb-2" rows="4"></textarea>
                <button onclick="createPost()" class="btn btn-primary">Post</button>

                <h2 class="mt-4">Timeline</h2>
                <div id="posts"></div>
            </div>
        </div>
    </div>

    <script>

        function createPost() {
            var postContent = document.getElementById('postContent').value;
            if (postContent) {
                var postDiv = document.createElement('div');
                postDiv.className = 'post border p-3 mb-3 bg-light';

                // Create a span for the post date
                var dateSpan = document.createElement('span');
                dateSpan.className = 'post-date';
                dateSpan.style.fontSize = '0.8em';
                dateSpan.style.color = 'grey';
                var currentDate = new Date();
                dateSpan.textContent = 'Posted on ' + currentDate.toLocaleString();

                // Append date and post content
                postDiv.appendChild(dateSpan);
                postDiv.appendChild(document.createElement('br'));
                postDiv.appendChild(document.createTextNode(postContent));

                var postsDiv = document.getElementById('posts');
                postsDiv.insertBefore(postDiv, postsDiv.firstChild);
                document.getElementById('postContent').value = '';
            }
        }

        function loadProfile() {
            const profileData = JSON.parse(decodeURIComponent(window.location.href.substr(window.location.href.lastIndexOf("?")+1)) );
            console.log(profileData)
            if (profileData) {
                var profileDiv = document.getElementById('profile');
                var profileHtml = '<h3>' + profileData.name + ' (' + profileData.species + ')</h3>';
                if (profileData.imageUrl) {
                    profileHtml += '<img src="' + profileData.imageUrl + '" width=170px>';
                }
                var profileDiv = document.getElementById('profile');
                profileDiv.innerHTML = profileHtml;
                profileDiv.className = 'profile p-3 border bg-light';
            }
        }
        loadProfile()
    </script>
</body>
</html>
